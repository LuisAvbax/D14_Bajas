<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:c="http://java.sun.com/jsp/jstl/core"
xmlns:p="http://primefaces.org/ui">

<ui:composition template="../templates/desktop.xhtml">
	<ui:define name="content" >
		<h:panelGrid columns="2">
			<div id="TituloPantalla" class="tituloPantalla">#{msg.detconsumo_titulo}</div>
		</h:panelGrid>
		<h:messages  globalOnly="true" showSummary="false"/>
		<h:form id="consForm">
			<p:messages id="msgFile" showSummary="false" showDetail="true" autoUpdate="true" closable="false" globalOnly="true"/>
			<h:panelGrid id="panelCarga" columns="6" border="0" style="margin: 0 auto;" 
			columnClasses="userDlglblcolumn,userDlgdatacolumn,userDlgerrorcolumn,userDlglblcolumn,userDlgdatacolumn,userDlgerrorcolumn">
			
			 <h:outputLabel id="mes_lbl"  for="mes" value="#{msg.reporte_polizasap_mes}:" />
        		<p:selectOneMenu id="mes" value="#{detconsumo.mes.id}" 
				style="width:153px" required="true"
				requiredMessage="#{msg.admsitio_campoobl}" >
				 	<f:selectItem itemLabel="#{msg.reporte_polizasap_seleccione}" itemValue="" />
					<f:selectItems value="#{detconsumo.meses}"  var="m"
        				itemLabel="#{m.nombre}"
        				itemValue="#{m.id}" />
        		</p:selectOneMenu>
        		<h:message style="color: red;
					     	font-family: 'New Century Schoolbook', serif;"
					     	id="mesMsg" for="mes"/>
        	
        	<h:outputLabel id="tarifa_lbl"  for="tarifa" value="#{msg.admsitio_tarifa}:" />
        		<p:selectCheckboxMenu id="tarifa" value="#{detconsumo.selectedRate}" label="#{msg.reporte_polizasap_seleccione}"
                              filter="true" filterMatchMode="startsWith" style="width:153px" widgetVar="rateVar">
            			<f:selectItems value="#{detconsumo.tarifas}" var="t"
            			itemLabel="#{t.clave}"
	        				itemValue="#{t.id}" />
        			</p:selectCheckboxMenu>
        		<h:message style="color: red;
					     	font-family: 'New Century Schoolbook', serif;"
					     	id="tarifaMsg" for="tarifa"/>	  		
				
			 <h:outputLabel id="anio_lbl"  for="anio" value="#{msg.reporte_polizasap_anio}:" />
        		<p:selectOneMenu id="anio" value="#{detconsumo.anio}" 
				style="width:153px" required="true"
				requiredMessage="#{msg.admsitio_campoobl}" >
				 	<f:selectItem itemLabel="#{msg.reporte_polizasap_seleccione}" itemValue="" />
					<f:selectItems value="#{detconsumo.anios}"/>
        		</p:selectOneMenu>
        		<h:message style="color: red;
					     	font-family: 'New Century Schoolbook', serif;"
					     	id="anioMsg" for="anio"/>
					     	
			 	     	
			<h:outputLabel id="division_lbl"  for="division" value="#{msg.admsitio_division}:" />
        		<p:selectOneMenu id="division" value="#{detconsumo.division.id}" 
				style="width:153px" >
				 	<f:selectItem itemLabel="#{msg.reporte_polizasap_seleccione}" itemValue="" />
					<f:selectItems value="#{detconsumo.divisiones}"  var="d"
        				itemLabel="#{d.nombre}"
        				itemValue="#{d.id}" />
        		</p:selectOneMenu>
        		<h:message style="color: red;
					     	font-family: 'New Century Schoolbook', serif;"
					     	id="divisionnMsg" for="division"/>
        	
			<h:outputLabel id="region_lbl"  for="region" value="#{msg.admsitio_region}:" />
        		<p:selectOneMenu id="region" value="#{detconsumo.region.id}" 
				style="width:153px" required="true"
				requiredMessage="#{msg.admsitio_campoobl}" >
				 	<f:selectItem itemLabel="#{msg.reporte_polizasap_seleccione}" itemValue="" />
					<f:selectItems value="#{detconsumo.regiones}"  var="m"
        				itemLabel="#{m.descripcion}"
        				itemValue="#{m.id}" />
        		</p:selectOneMenu>
        		<h:message style="color: red;
					     	font-family: 'New Century Schoolbook', serif;"
					     	id="regionMsg" for="region"/>		     	
			
        	
        	<h:outputLabel id="proyecto_lbl"  for="proyectoVal" value="#{msg.admsitio_proyecto}:" />
        		        		
	        		<p:selectCheckboxMenu id="proyectoVal" value="#{detconsumo.selectedProyects}" label="#{msg.reporte_polizasap_seleccione}"
                              filter="true" filterMatchMode="startsWith" style="width:153px" widgetVar="proVar">
            			<f:selectItems value="#{detconsumo.proyectos}" var="p"
            			itemLabel="#{p.clave}"
	        				itemValue="#{p.id}" />
        			</p:selectCheckboxMenu>
	        		<h:message style="color: red;
					     	font-family: 'New Century Schoolbook', serif;"
					     	id="proyecto_edMsg" for="proyecto_edVal2"/>
					     	
			<h:outputLabel id="proveedor_lbl"  for="proveedorVal" value="#{msg.detconsumo_proveedor}:" />
	        		<p:selectOneMenu id="proveedorVal" value="#{detconsumo.proveedor.id}" 
					style="width:153px" required="true"
				requiredMessage="#{msg.admsitio_campoobl}" >
					 	<f:selectItem itemLabel="#{msg.reporte_polizasap_seleccione}" itemValue="" />
						<f:selectItems value="#{detconsumo.proveedores}"  var="p"
	        				itemLabel="#{p.clave}"
	        				itemValue="#{p.id}" />
	        		</p:selectOneMenu>	
	        		<h:message style="color: red;
					     	font-family: 'New Century Schoolbook', serif;"
					     	id="proveedor_edMsg" for="proveedorVal"/>	
        		
			</h:panelGrid>

			<p:spacer height="10px"/> 
			
			<h:panelGrid columns="3" style="margin: 0 auto;">
				<p:commandButton id="admSitBtn" value="#{msg.btn_consultar}" action="consultaConsumos" global="true" update="consForm"/>
					<p:commandButton value="#{msg.btn_regresar}" immediate="true" action="regresa"  />
					<p:commandButton value="#{msg.btn_limpiar}" immediate="true" action="limpia"  />		
            </h:panelGrid>
			<p:spacer height="30px"/>
			
			<h:panelGrid columns="2"
				cellpadding="5" border="0">
				
				<h:commandLink rendered="#{detconsumo.descarga}">
					<h:graphicImage value="/css/iconos/excel-icon.png" style="width : 33px; height : 33px;"/>
	                <p:dataExporter type="xls" target="dataTableConsumos" fileName="Consumos" />
            	</h:commandLink>
            
			</h:panelGrid>

			<p:dataTable id="dataTableConsumos" paginator="true" rows="10"
				rowIndexVar="rowNum" paginatorPosition="bottom"
				paginatorTemplate=" {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown} Total de Registros: #{detconsumo.consumos.size()}"
				rowsPerPageTemplate="10,20" var="c"
				value="#{detconsumo.consumos}">

				<f:facet name="header">
				</f:facet>
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.detconsumo_proveedor}" />
					</f:facet>
					<h:outputText value="#{c.cfeCatProveedor.clave}" />
				</p:column>
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.admsitio_proyecto}" />
					</f:facet>
					<h:outputText value="#{c.cfeOpSitio.proyecto.clave}" />
				</p:column>
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.admsitio_region}" />
					</f:facet>
					<h:outputText value="#{c.cfeOpSitio.region.clave}" />
				</p:column>
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.admsitio_rpu}" />
					</f:facet>
					<h:outputText value="#{c.id.consumoRpu}" />
				</p:column>
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.admsitio_division}" />
					</f:facet>
					<h:outputText value="#{c.cfeOpSitio.division.nombre}" />
				</p:column>
				
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.admsitio_poblacion}" />
					</f:facet>
					<h:outputText value="#{c.cfeOpSitio.cfeCatEstado.nombre}" />
				</p:column>
				
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.admsitio_nombre}" />
					</f:facet>
					<h:outputText value="#{c.cfeOpSitio.nombre}" />
				</p:column>
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.detconsumo_kwh}"  />
					</f:facet>
					<h:outputText value="#{c.kwh}">
					<f:convertNumber pattern="##,##0.00" />
					</h:outputText>
					<f:facet name="footer">
            			<h:outputText id="consumoTotal" value="#{detconsumo.kwhTotal}">
            			<f:convertNumber pattern="##,##0.00" />
            			</h:outputText>
        			</f:facet>
				</p:column>
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.detconsumo_energia}"  />
					</f:facet>
					<h:outputText value="#{c.energia}">
					<f:convertNumber pattern="##,##0.00" />
					</h:outputText>
					<f:facet name="footer">
            			<h:outputText id="energiaTotal" value="#{detconsumo.energiaTotal}">
            			<f:convertNumber pattern="##,##0.00" />
            			</h:outputText>
        			</f:facet>
				</p:column>
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.detconsumo_iva}"  />
					</f:facet>
					<h:outputText value="#{c.iva}">
					<f:convertNumber pattern="##,##0.00" />
					</h:outputText>
					<f:facet name="footer">
            			<h:outputText id="ivaTotal" value="#{detconsumo.ivaTotal}">
            			<f:convertNumber pattern="##,##0.00" />
            			</h:outputText>
        			</f:facet>
				</p:column>
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.detconsumo_dap}"  />
					</f:facet>
					<h:outputText value="#{c.dap}">
					<f:convertNumber pattern="##,##0.00" />
					</h:outputText>
					<f:facet name="footer">
            			<h:outputText id="dapTotal" value="#{detconsumo.dapTotal}">
            			<f:convertNumber pattern="##,##0.00" />
            			</h:outputText>
        			</f:facet>
				</p:column>
				
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.detconsumo_otros}"  />
					</f:facet>
					<h:outputText value="#{c.otros}">
					<f:convertNumber pattern="##,##0.00" />
					</h:outputText>
					<f:facet name="footer">
            			<h:outputText id="otrosTotal" value="#{detconsumo.otrosTotal}">
            			<f:convertNumber pattern="##,##0.00" />
            			</h:outputText>
        			</f:facet>
				</p:column>
				
				
				<p:column style="text-align: left;">
					<f:facet name="header">
						<h:outputText value="#{msg.detconsumo_total}"  />
					</f:facet>
					<h:outputText value="#{c.total}">
					<f:convertNumber pattern="##,##0.00" />
					</h:outputText>
					<f:facet name="footer">
            			<h:outputText id="totalTotal" value="#{detconsumo.totalTotal}">
            			<f:convertNumber pattern="##,##0.00" />
            			</h:outputText>
        			</f:facet>
				</p:column>
				
				
			</p:dataTable>
			 
			</h:form>

		
	</ui:define>
</ui:composition>
</html>